{% import "_macros.html" as macros %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>作品-基于Flask框架的艺术创作平台</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <link rel="stylesheet" href="static/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,700">
    <link rel="stylesheet" href="static/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="static/fonts/ionicons.min.css">
    <link rel="stylesheet" href="static/fonts/simple-line-icons.min.css">
    <link rel="stylesheet" href="static/css/-Login-form-Page-BS4-.css">
    <link rel="stylesheet" href="static/css/Animated-CSS-Waves-Background-SVG.css">
    <link rel="stylesheet" href="static/css/Bootstrap-DataTables.css">
    <link rel="stylesheet" href="static/css/Bootstrap-Image-Uploader.css">
    <link rel="stylesheet" href="static/css/Custom-Upload-File.css">
    <link rel="stylesheet" href="static/css/Drag--Drop-Upload-Form.css">
    <link rel="stylesheet" href="static/css/Drag-Drop-File-Upload.css">
    <link rel="stylesheet" href="static/css/Dynamic-Table-1.css">
    <link rel="stylesheet" href="static/css/Elegant-Registration-Form.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.6.1/css/pikaday.min.css">
    <link rel="stylesheet" href="static/css/Login-Form-Dark.css">
    <link rel="stylesheet" href="static/css/MUSA_no-more-tables-1.css">
    <link rel="stylesheet" href="static/css/MUSA_no-more-tables.css">
    <link rel="stylesheet" href="static/css/MUSA_panel-table-1.css">
    <link rel="stylesheet" href="static/css/MUSA_panel-table.css">
    <link rel="stylesheet" href="static/css/mycss.css">
    <link rel="stylesheet" href="static/css/Pretty-Product-List.css">
    <link rel="stylesheet" href="static/css/Pretty-Registration-Form.css">
    <link rel="stylesheet" href="static/css/Pretty-User-List.css">
    <link rel="stylesheet" href="static/css/responsive-registration-form-1.css">
    <link rel="stylesheet" href="static/css/responsive-registration-form.css">
    <link rel="stylesheet" href="static/css/Table-With-Search-1.css">
    <link rel="stylesheet" href="static/css/Table-With-Search.css">
    <link rel="stylesheet" href="static/css/User-Information-Panel---Lite--Secondary-User-Panel-Footer.css">
</head>

<body>
    <nav class="navbar navbar-dark navbar-expand-lg fixed-top bg-white portfolio-navbar gradient">
        <div class="container"><a class="navbar-brand border rounded shadow-lg logo" href="{{ buildUrl('/') }}" target="_blank">艺术创作平台</a><button data-toggle="collapse" class="navbar-toggler" data-target="#navbarNav"><span class="sr-only">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div
                class="collapse navbar-collapse" id="navbarNav">
                <ul class="nav navbar-nav ml-auto">
                    <li class="nav-item" role="presentation" id="navbarNavli1"><a class="nav-link border rounded shadow-lg" href="{{ buildUrl('/') }}">网站主页</a></li>
                    <li class="nav-item" role="presentation" id="navbarNavli7"><a class="nav-link border rounded shadow-lg" href="{{ buildUrl('/ViewAllWorks') }}">全网动态</a></li>
                    <li class="nav-item" role="presentation" id="navbarNavli2"><a class="nav-link border rounded shadow-lg active" href="{{ buildUrl('/projectIntroduction') }}">项目介绍</a></li>
                    {% if current_user: %}
                    <li class="nav-item" role="presentation" id="navbarNavli5"><a class="nav-link border rounded shadow-lg" href="{{ buildUrl('createArtPicture')}}">欢迎{% if current_user: %} {{current_user.email }} {% endif%}进行创作</a></li>
                    <li class="nav-item" role="presentation" id="navbarNavli8"><a class="nav-link border rounded shadow-lg" href="{{ buildUrl('/viewMyPost')}}">我的作品</a></li>
                    <li class="nav-item" role="presentation" id="navbarNavli6"><a class="nav-link border rounded shadow-lg" href="{{ buildUrl('/logout') }}">退出</a></li>
                    {% endif%}
                    {% if not current_user: %}
                    <li class="nav-item" role="presentation" id="navbarNavli3"><a class="nav-link border rounded shadow" href="{{ buildUrl('/memberRegister') }}">注册</a></li>
                    <li class="nav-item" role="presentation" id="navbarNavli4"><a class="nav-link border rounded shadow" href="{{ buildUrl('/memberLogin') }}">登录</a></li>
                    {% endif%}
                </ul>
            </div>
        </div>
    </nav>
    <main class="page lanidng-page">
        <section class="portfolio-block call-to-action border-bottom">
            <h1 class="text-monospace text-uppercase text-center text-muted bg-warning border rounded border-dark shadow-lg" align="center">评价作品</h1>
            <div>
                <div align="center">
                    <div class="product-container">
                        <div class="row">
                            <div class="col-md-12"><img class="img-thumbnail bg-success shadow" id="anUserWorks1" src="{{work_info.transfer_photo_imageurl}}" width="45%" alt="作品图片"></div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <p id="anUserWorks1Text" class="product-description">{{work_info.tag}}</p>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12"><strong align="right">{{work_info.nickname}}</strong></div>
                        </div>
                        <div class="row" style='display:none;'>
                            <div class="col-12" ><strong id="theIDOfTheWork"  align="right">{{work_info.id}}</strong></div>
                        </div>
                        <div class="row">
                            <div class="col-12"><strong align="right">{{work_info.time}}</strong></div>
                        </div>
                    </div>
                </div>
                <form action="" method="POST">
                    <div align="center">
                        <textarea id="evaluateText" name="comment" style="color:#ffffff;font-family: Tahoma, sans-serif;      width: 600px;     height: 320px;     padding: 5px;      border: 3px solid #bcb; background-image: url(/static/img/butterfly.gif); background-repeat:no-repeat;background-position: bottom right;"
                            placeholder="在这里输入您的评价内容" rows="5" maxlength="140" autofocus="" autocomplete="on" inputmode="verbatim"></textarea>
                    </div>
                    <div align="center">
                        <input class="btn btn-outline-success text-primary" type="submit" value="提交评价" onclick="getEvaluateText()">
                    </div>
                </form>
            </div>
        </section>
		<ul class="comments">
            {% for comment in workcomment_info %}
            <li class="comment">
                <div style="font-size:30px;" class="comment-body">{{ comment.comment}}</div>
                <div style="font-size:30px;" class="comment-body">{{ comment.time}}</div>
                <div style="margin-left:500px; font-size:30px;" class="comment-author">{{ comment.commentUid}}</div>
            </li>
            {% endfor %}
        </ul>
        {% if pagination %}
        <div class="pagination" style="margin-left:500px; font-size:30px;">
            {{ macros.pagination_widget(pagination, '.comment' ,work_id = work_id) }}
        </div>
        {% endif %}
    </main>
    <footer class="page-footer">
        <div class="container">
            <div class="links"><a href="/aboutAndContactUs">关于我们</a><a href="/aboutAndContactUs">联系我们</a><a href="/projectIntroduction">项目介绍</a></div>
        </div>
    </footer>
    <script src="static/js/jquery.min.js"></script>
    <script src="static/bootstrap/js/bootstrap.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
    <script src="static/js/Bootstrap-DataTables.js"></script>
    <script src="static/js/Bootstrap-Image-Uploader.js"></script>
    <script src="static/js/Custom-Upload-File.js"></script>
    <script src="static/js/Dynamic-Table-1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pikaday/1.6.1/pikaday.min.js"></script>
    <script src="static/js/Table-With-Search.js"></script>
    <script>
        function getEvaluateText(){
            alert("getEvaluateText()函数成功触发");
            var anEvaluateText = document.getElementById("evaluateText").value.toString();
            var theID=document.getElementById("theIDOfTheWork").innerHTML.toString();
            alert("变量成功var完"+anEvaluateText+"ID"+theID);
            $.ajax({
                type: "POST",
                dataType: "json",
                url: "/comment",//路径未定
                data: {'anEvaluateText': anEvaluateText, 'ID':theID},//i表示获取第i个作品动态
                // 主要是前端给后端返回的作品评价的内容
                // 后端只需要返回给前端一个code，用以检验保存评价内容是否成
                success: function (resp){
                    alert("进入success()函数！");
                    if (resp.code === 200) {
                        alert("评价成功");
                        alert(theID);
                        window.location.href ="http://49.233.31.42:8999/comment"+"?id="+theID;
                    }
                    else{
                        alert("评价失败");
                        window.location.href = "http://49.233.31.42:8999/comment"+"?id="+theID;
                    }
                },
                error: function (result) {
                    alert("发生未知错误！请检查自己的网络。" + result);
                }

            });

        }


    </script>
</body>

</html>